!function(t,n,o,i){function e(n,o){this.options=t.extend({},s,o),this.element=n,this.init()}var a="jCombo",s={url:null,parent:null,first_optval:"",input_param:null,data:null,selected_value:null,onLoad:null,onChange:null,initial_text:"-- Please Select --",method:"GET",dataType:"jsonp",cache:!0};e.prototype={_addParameter:function(t,n){return null==t||null==n?!1:(this.options.data=t+"="+n,!0)},_getJson:function(n,o){var i=this,e=null!=i.options.orig_data?i.options.orig_data:"";e+=null!=i.options.data?i.options.data:"",t.ajax({url:n,data:e,type:i.options.dataType,dataType:i.options.dataType,method:i.options.method,success:o})},_onLoadCall:function(){if(null!=this.options.onLoad){var t=this.options.onLoad;this.options.onLoad=null,t()}},_getData:function(t,o){var i=this;n.__jcombo_data_cache="undefined"==typeof n.__jcombo_data_cache?{}:n.__jcombo_data_cache;var e=JSON.stringify(t+i.options.orig_data+"&"+i.options.data);n.__jcombo_data_cache[e]&&i.options.cache?setTimeout(function(){o(n.__jcombo_data_cache[e])},0):i._getJson(t,function(t){n.__jcombo_data_cache[e]=t,o(t)})},_renderOption:function(t,n,o){var i="";return 1==o&&(i=' selected="selected"'),'<option value="'+t+'"'+i+">"+n+"</option>"},_firstOption:function(){return""==this.initial_text?"":this._renderOption(this.options.first_optval,this.options.initial_text,!1)},_renderSelect:function(t,n){var o=[];"undefined"==typeof n&&(n=this.options.first_optval),o.push(this._firstOption());for(var i in t){var e=t[i];o.push(this._renderOption(e.id,e.value,e.id==n))}return o.join("")},_bindSelect:function(n,o){var i=this,e=this.options.url;o=null==o?n:o,null==this.options.input_param?e+=null==n?"":n:this._addParameter(this.options.input_param,o);t(i.element).attr("id");o==this.options.first_optval||n==this.options.first_optval?(t(this.element).html(this._firstOption()),t(this.element).attr("disabled","disabled"),t(i.element).trigger("change"),i._onLoadCall()):(i.options.selected_value=o,this._getData(e,function(e){t(i.element).html(i._renderSelect(e,o)),i._onLoadCall(),(null!=o||null==n)&&(t(i.element).trigger("change"),null!=i.options.onChange&&i.options.onChange(o)),e.length>0&&t(i.element).removeAttr("disabled")}))},init:function(){var n=this;this.options.orig_data=this.options.data,null!=this.options.parent?t(this.options.parent).each(function(o,i){t(i).val();t(i).bind("change",function(){n._bindSelect(t(i).val(),n.options.selected_value)})}):this._bindSelect(null,n.options.selected_value)}},t.fn[a]=function(n){return this.each(function(){t.data(this,"plugin_"+a)||t.data(this,"plugin_"+a,new e(this,n))})}}(jQuery,window,document);